<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biodiversity Atlas Indonesia - Katalog Keanekaragaman Hayati</title>
    <link rel="stylesheet" href="css/index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.css" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="navbar-placeholder"></div>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-background">
            <div class="gradient-overlay"></div>
            <div class="animated-shapes">
                <div class="shape shape-1"></div>
                <div class="shape shape-2"></div>
                <div class="shape shape-3"></div>
            </div>
        </div>
        <div class="container">
            <div class="hero-content">
                <div class="hero-badge">
                    <span class="badge-icon">üå±</span>
                    <span>Digital Innovation for Sustainable Nature</span>
                </div>
                <h1 class="hero-title">
                    Jelajahi <span class="gradient-text">Keanekaragaman Hayati</span> Indonesia
                </h1>
                <p class="hero-description">
                    Atlas interaktif yang menghubungkan masyarakat dengan kekayaan alam Indonesia. 
                    Temukan, pelajari, dan berkontribusi dalam upaya konservasi spesies endemik dan terancam punah.
                </p>
                
                <!-- Search Bar -->
                <div class="hero-search">
                    <div class="search-box">
                        <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-4.35-4.35M11 19a8 8 0 100-16 8 8 0 000 16z"/>
                        </svg>
                        <input type="text" placeholder="Cari spesies berdasarkan nama..." id="heroSearch">
                        <button class="search-btn">Cari</button>
                    </div>
                    <div class="search-suggestions" id="searchSuggestions"></div>
                </div>

                <div class="hero-cta">
                    <a href="catalog.html" class="btn btn-primary">
                        <span>Jelajahi Katalog</span>
                        <span class="btn-icon">‚Üí</span>
                    </a>
                    <a href="submit.html" class="btn btn-secondary">
                        <span class="btn-icon">üì∏</span>
                        <span>Laporkan Temuan</span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Species -->
    <section class="featured-section">
        <div class="container">
            <div class="section-header">
                <div class="section-badge">
                    <svg class="telwin-emote w-6 h-6" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <!-- leaf outline -->
                        <path d="M3 12c2.5-6 9-9 18-9-1 7-4 12-9 15-5-3-8-6-9-6z" stroke="#278E29" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                        <!-- leaf fill -->
                        <path d="M6.5 12.5c2-3 5-4 8-4" stroke="#278E29" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <!-- small accent dot -->
                        <circle cx="19" cy="5" r="0.9" fill="#278E29"/>
                    </svg>
                    <span>Spesies Unggulan</span>
                </div>
                <h2 class="section-title">Spesies Ikonik Indonesia</h2>
                <p class="section-description">
                    Kenali lebih dekat spesies-spesies endemik dan terancam yang menjadi kebanggaan keanekaragaman hayati Indonesia
                </p>
            </div>

            <div class="species-carousel" id="featuredCarousel">
                <!-- Will be populated by JavaScript -->
            </div>

            <div class="carousel-controls">
                <button class="carousel-btn prev" id="carouselPrev">‚Üê</button>
                <div class="carousel-dots" id="carouselDots"></div>
                <button class="carousel-btn next" id="carouselNext">‚Üí</button>
            </div>
        </div>
    </section>

    <!-- Conservation Status Overview -->
    <section class="conservation-section">
        <div class="container">
            <div class="conservation-grid">
                <div class="conservation-content">
                    <div class="section-badge">
                        <span>üõ°Ô∏è</span>
                        <span>Status Konservasi</span>
                    </div>
                    <h2 class="section-title">Memahami Tingkat Ancaman</h2>
                    <p class="text-content">
                        Sistem klasifikasi IUCN membantu kita memahami seberapa mendesak upaya konservasi yang dibutuhkan. 
                        Setiap spesies dievaluasi berdasarkan ukuran populasi, laju penurunan, dan tingkat ancaman.
                    </p>
                    <div class="status-legend">
                        <div class="status-item">
                            <div class="status-badge status-cr">CR</div>
                            <div class="status-info">
                                <strong>Critically Endangered</strong>
                                <span>Kritis - Menghadapi risiko kepunahan sangat tinggi</span>
                            </div>
                        </div>
                        <div class="status-item">
                            <div class="status-badge status-en">EN</div>
                            <div class="status-info">
                                <strong>Endangered</strong>
                                <span>Terancam - Risiko kepunahan tinggi di alam liar</span>
                            </div>
                        </div>
                        <div class="status-item">
                            <div class="status-badge status-vu">VU</div>
                            <div class="status-info">
                                <strong>Vulnerable</strong>
                                <span>Rentan - Menghadapi risiko kepunahan sedang</span>
                            </div>
                        </div>
                        <div class="status-item">
                            <div class="status-badge status-nt">NT</div>
                            <div class="status-info">
                                <strong>Near Threatened</strong>
                                <span>Hampir Terancam - Berisiko menjadi terancam di masa depan</span>
                            </div>
                        </div>
                        <div class="status-item">
                            <div class="status-badge status-lc">LC</div>
                            <div class="status-info">
                                <strong>Least Concern</strong>
                                <span>Risiko Rendah - Populasi relatif stabil</span>
                            </div>
                        </div>
                    </div>
                    <a href="catalog.html" class="btn btn-outline">
                        <span>Lihat Semua Spesies</span>
                        <span class="btn-icon">‚Üí</span>
                    </a>
                </div>
                <div class="conservation-chart">
                    <div class="chart-container">
                        <canvas id="conservationChart"></canvas>
                    </div>
                    <div class="chart-stats">
                        <div class="chart-stat-item">
                            <span class="chart-stat-number" id="totalSpecies">25</span>
                            <span class="chart-stat-label">Total Spesies</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section class="how-it-works">
        <div class="container">
            <div class="section-header centered">
                <div class="section-badge">
                    <svg class="icon text-[#278E29] w-7 h-7" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                        <path d="M9 18a3 3 0 0 0 6 0c0-1.657-1.343-3-3-3s-3 1.343-3 3z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M12 2v3" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M7 7a5 5 0 0 1 10 0c0 2.5-2 4.5-5 6-3-1.5-5-3.5-5-6z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span>Cara Berkontribusi</span>
                </div>
                <h2 class="section-title">Jadilah Bagian dari Konservasi</h2>
                <p class="section-description">
                    Setiap orang dapat berkontribusi dalam upaya pelestarian keanekaragaman hayati Indonesia
                </p>
            </div>

            <div class="steps-grid">
                <div class="step-card">
                    <div class="step-number">01</div>
                    <div class="step-icon">
                        <svg class="icon text-[#278E29]" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h3 class="step-title">Jelajahi</h3>
                    <p class="step-description">
                        Browse katalog spesies dan pelajari tentang habitat, status konservasi, dan fakta menarik
                    </p>
                </div>
                <div class="step-card">
                    <div class="step-number">02</div>
                    <div class="step-icon">
                        <svg class="icon text-[#278E29]" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M21 10c0 6-9 12-9 12S3 16 3 10a9 9 0 1118 0z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="12" cy="10" r="2" fill="currentColor"/>
                        </svg>
                    </div>
                    <h3 class="step-title">Observasi</h3>
                    <p class="step-description">
                        Gunakan peta interaktif untuk melihat lokasi observasi dan sebaran spesies di seluruh Indonesia
                    </p>
                </div>
                <div class="step-card">
                    <div class="step-number">03</div>
                    <div class="step-icon">
                        <svg class="icon text-[#278E29]" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <rect x="3.5" y="7" width="17" height="11" rx="2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M8 7V5a2 2 0 012-2h4a2 2 0 012 2v2" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="12" cy="12.5" r="2.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h3 class="step-title">Laporkan</h3>
                    <p class="step-description">
                        Upload foto temuan Anda dengan lokasi dan catatan untuk membantu penelitian konservasi
                    </p>
                </div>
                <div class="step-card">
                    <div class="step-number">04</div>
                    <div class="step-icon">
                        <svg class="icon text-[#278E29]" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                            <path d="M4 7v6a8 8 0 008 8 8 8 0 008-8V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M12 3l3 2-3 2-3-2 3-2z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <h3 class="step-title">Belajar</h3>
                    <p class="step-description">
                        Ikuti kuis edukasi dan dapatkan badge untuk meningkatkan pemahaman tentang biodiversitas
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="container">
            <div class="cta-content">
                <h2 class="cta-title">Siap Memulai Perjalanan Eksplorasi?</h2>
                <p class="cta-description">
                    Bergabunglah dengan ribuan kontributor yang telah membantu mendokumentasikan keanekaragaman hayati Indonesia
                </p>
                <div class="cta-buttons">
                    <a href="catalog.html" class="btn btn-primary btn-large">
                        <span>Mulai Jelajah</span>
                        <span class="btn-icon">‚Üí</span>
                    </a>
                    <a href="about.html" class="btn btn-outline btn-large">
                        <span>Pelajari Lebih Lanjut</span>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <div id="footer-placeholder"></div>

    <!-- Load component loader first, then other scripts -->
    <script src="js/components-loader.js"></script>
    <script src="js/script.js"></script>
    <script src="js/home.js"></script>

    <!-- Flowbite JS for Dropdown Component -->
    <script src="https://cdn.jsdelivr.net/npm/flowbite@2.5.2/dist/flowbite.min.js"></script>

    <!-- Chart.js for Conservation Chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script>
        // Conservation Status Chart
        let conservationChart = null;

        // Function to load and update chart with real data
        async function loadConservationChart() {
            const ctx = document.getElementById('conservationChart');
            if (!ctx) return;

            try {
                // Load species data including approved submissions
                await BiodiversityAtlas.loadSpeciesData();
                const speciesData = BiodiversityAtlas.speciesData;

                // Count species by conservation status
                const statusCount = {
                    'Critically Endangered': 0,
                    'Endangered': 0,
                    'Vulnerable': 0,
                    'Near Threatened': 0,
                    'Least Concern': 0,
                    'Data Deficient': 0,
                    'Not Evaluated': 0
                };

                // Count each species
                speciesData.forEach(species => {
                    const status = species.conservationStatus;
                    if (statusCount.hasOwnProperty(status)) {
                        statusCount[status]++;
                    }
                });

                const total = Object.values(statusCount).reduce((a, b) => a + b, 0);
                document.getElementById('totalSpecies').textContent = total;

                // Chart data - only show categories with data > 0
                const chartLabels = [];
                const chartValues = [];
                const chartColors = [];
                const chartBorders = [];

                const statusConfig = [
                    { name: 'Critically Endangered', bg: 'rgba(220, 38, 38, 0.8)', border: 'rgb(220, 38, 38)' },
                    { name: 'Endangered', bg: 'rgba(234, 88, 12, 0.8)', border: 'rgb(234, 88, 12)' },
                    { name: 'Vulnerable', bg: 'rgba(245, 158, 11, 0.8)', border: 'rgb(245, 158, 11)' },
                    { name: 'Near Threatened', bg: 'rgba(132, 204, 22, 0.8)', border: 'rgb(132, 204, 22)' },
                    { name: 'Least Concern', bg: 'rgba(16, 185, 129, 0.8)', border: 'rgb(16, 185, 129)' },
                    { name: 'Data Deficient', bg: 'rgba(156, 163, 175, 0.8)', border: 'rgb(156, 163, 175)' },
                    { name: 'Not Evaluated', bg: 'rgba(209, 213, 219, 0.8)', border: 'rgb(209, 213, 219)' }
                ];

                statusConfig.forEach(config => {
                    if (statusCount[config.name] > 0) {
                        chartLabels.push(config.name);
                        chartValues.push(statusCount[config.name]);
                        chartColors.push(config.bg);
                        chartBorders.push(config.border);
                    }
                });

                const chartData = {
                    labels: chartLabels,
                    datasets: [{
                        data: chartValues,
                        backgroundColor: chartColors,
                        borderColor: chartBorders,
                        borderWidth: 2
                    }]
                };

                // If chart already exists, destroy and recreate it
                if (conservationChart) {
                    conservationChart.destroy();
                }

                // Create new chart
                conservationChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: chartData,
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    padding: 15,
                                    font: {
                                        size: 12,
                                        family: "'Inter', sans-serif"
                                    },
                                    usePointStyle: true,
                                    pointStyle: 'circle'
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.parsed || 0;
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return label + ': ' + value + ' spesies (' + percentage + '%)';
                                    }
                                }
                            }
                        },
                        cutout: '65%'
                    }
                });
            } catch (error) {
                console.error('Error loading conservation chart:', error);
            }
        }

        // Load chart on page load
        document.addEventListener('DOMContentLoaded', loadConservationChart);

        // Reload chart when theme changes
        window.addEventListener('themeChanged', function() {
            loadConservationChart();
        });

        // Make function available globally for reloading after submit
        window.reloadConservationChart = loadConservationChart;
    </script>
</body>
</html>